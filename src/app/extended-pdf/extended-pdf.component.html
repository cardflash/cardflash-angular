<div class="mainArea">
  <div class="pdfViewer">
    <ngx-extended-pdf-viewer
      #ngxPdfViewer
      [listenToURL]="true"
      [src]="pdfSrc"
      [useBrowserLocale]="true"
      [(page)]="currPageNumber"
      (pageChange)="onPageChange($event)"
      [textLayer]="true"
      (textLayerRendered)="textLayerRendered($event)"
      [zoom]="'page-fit'"
      (sidebarVisibleChange)="calcScaling()"
      (pagesLoaded)="pagesLoadComplete($event)"
      (pdfLoaded)="pdfLoaded($event)"
      (pdfLoadingFailed)="pdfLoadFailed($event)"
      (pageRendered)="pageRendered($event)"
      [ignoreKeys]="['1', '2', 'w', 's', 'space']"
      [enablePinchOnMobile]="true"
      [showBorders]="false"
      [pageViewMode]="'multiple'"
      [height]="'100%'"
      [handTool]="false"
      [authorization]="true"
    ></ngx-extended-pdf-viewer>
  </div>
  <div class="annotationsColumn">
    <h2>Annotations</h2>
    <canvas style="display: none" #previewCanvas></canvas>
    <div *ngFor="let annotations of annotationForPage | keyvalue">
      <h3>Page {{ annotations.key }}</h3>
      <app-annotation
        *ngFor="let annotation of annotations.value"
        [annotation]="annotation"
        (showInDocument)="scrollToAnnotation({ annotationID: $event, where: 'both' })"
        (deleteAnnotation)="deleteAnnotation($event.id)"
        (updateAnnotation)="updateAnnotation($event)"
      >
      </app-annotation>
    </div>
  </div>
</div>
<div
  id="selectionTools"
  #selectionTools
  class="toolsInvisble"
  [ngClass]="{ toolsVisible: !getSelection() }"
>
    <button mat-icon-button (click)="addHighlightForSelection()">
      <mat-icon>text_fields</mat-icon>
    </button>
    <button mat-icon-button
      *ngFor="let color of utils.availableAnnotationColors" 
      (click)="addHighlightForSelection(color)"
    >
      <mat-icon [style]="'color: ' + color.hex.substr(0, 7) + '90'">circle</mat-icon>
    </button>
</div>

<div
  class="areaSelection"
  #areaSelection
  [ngStyle]="{
    'left.px': getMin(rect.x1, rect.x2),
    'top.px': getMin(rect.y1, rect.y2),
    'width.px': getAbs(rect.x1 - rect.x2),
    'height.px':  getAbs(rect.y1 - rect.y2)
  }"
></div>
